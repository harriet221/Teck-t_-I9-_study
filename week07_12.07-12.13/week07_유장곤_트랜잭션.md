# 트랜잭션(Transaction)
---
### 1. 개요
---
- 데이터베이스의 상태를 변화시키기 위해 수행하는 작업의 단위
- 데이터베이스의 무결성이 보장되는 상태에서 요청된 작업을 완수하기 위한 작업의 기본 단위
- 결론 : DB 트랜잭션은 데이터베이스의 상태를 변화시키는 일련의 작업들을 하나의 논리적인 작업 단위로 묶어주는 개념

### 2. 목적
---
- 데이터의 일관성과 안정성
- 데이터베이스에서 일어나는 다수의 작업을 하나의 작업으로 묶어 모든 작업이 성공할 경우에만 영구 적용되도록 보장 + 데이터 조작 명령문들의 실행 단위를 지정해 데이터의 무결성 보장.


### 2. ACID 속성
---
- 원자성 (Atomicity) : 랜잭션의 모든 작업은 전부 실행되거나 전부 실행되지 않아야 한다.
즉, 트랜잭션 내의 작업 중 하나라도 실패할 경우, 다른 작업들도 모두 취소되어야 함.(All or Nothing).
```
원자성을 위한 연산은 'Commit(완료)' 와 'Rollback(복귀)'연산이 있다.
Commit(완료)연산 : 트랜잭션 실행이 성공적으로 종료되었음을 선언
Rollback(복귀) 연산 : 트랜잭션의 실행이 실패했음을 선언하는 것 -> 원상 복귀 시켜야함.

```
- 일관성 (Consistency) : 트랜잭션이 완료된 후에도 데이터베이스는 항상 일관된 상태여야 한다. 
즉, 데이터베이스는 트랜잭션 전과 후의 상태가 일관되어야 한다.

- 독립성 (Isolation) : 동시에 여러 트랜잭션이 수행될 때, 각 트랜잭션은 서로에게 영향을 주지 않고 독립적으로 수행되는 것처럼 보여야 한다.

- 지속성 (Durability) : 트랜잭션이 성공적으로 완료된 후에는 그 결과가 영구적으로 반영되어야 한다. 
즉, 시스템 장애 또는 기타 문제가 발생해도 데이터는 유지되어야 합니다

### 3. 원자성을 위한 연산
---
3-1. Commit(저장) : 
- 하나의 트랜잭션이 성공적으로 끝나 데이터베이스가 일관성 있는 상태.

3.2 Rollback(철회) : 
- 하나의 트랜잭션이 비정상인 경우,상태. 트랜잭션의 원자성이 깨진 경우.

- 롤백이 발생하면 트랜잭션을 다시 실행하거나 부분적으로 변경된 결과를 취소할 수 있다.

### 4. 상태
---

![](https://velog.velcdn.com/images/ujgon/post/531fe032-0fc5-4fc5-b954-f48240b7bc47/image.png)


* 활동(Active)
    * 트랜잭션이 시작 혹은 현재 실행 중인 상태
    

* 부분적 완료 (Partially Committed)
    * 트랜잭션의 연산이 마지막 명령문까지 실행되고 Commit이 되기 직전 상태
    

* 완료 (Committed)
    * 트랜잭션이 성공적으로 종료되어 Commit 연산을 실행한 후의 상태
    

* 실패 (Failed)
    * 트랜잭이 실행되다 오류가 발생해서 중단된 상태

* 철회 (Aborted)
    * 브랜잭션이 비정상 종료되어 Rollback 연산이 수행된 상태. 
    -> 1. 트랜잭션 재실행 : 다시 새로운 트랜잭션으로 취급되어 재시작 
    or 2. 트랜잭션 폐기 : 내부적 오류로 재작성 혹은 원하는 db가 없는 경우.




출처 : 
https://wonit.tistory.com/462
https://sommda.tistory.com/97
